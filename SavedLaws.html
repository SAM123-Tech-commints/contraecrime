<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contra E-Crime</title>
    <link rel="icon" type="image/png" href="https://i.imgur.com/Dccn8pc.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        body, html {
            min-height: 100vh;
            margin: 0;
            padding: 0;
            font-family: 'Montserrat', sans-serif;
            background-color: #f7f7f7;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        body.dark-theme {
            background-color: #121212;
            color: #e0e0e0;
        }

        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .loader-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid #FFF;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }

        @keyframes rotation {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .dark-theme .loader {
            border-color: #d7b15c;
            border-bottom-color: transparent;
        }

        .avatar-loading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 101;
        }

        .avatar-loading.active {
            display: flex;
        }

        .avatar-loading .loader {
            width: 24px;
            height: 24px;
            border: 3px solid #FFF;
            border-bottom-color: transparent;
            border-radius: 50%;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }

        .dark-theme .avatar-loading .loader {
            border-color: #d7b15c;
            border-bottom-color: transparent;
        }

        .container {
            display: flex;
            min-height: 100vh;
            flex-direction: column;
        }

        .sidebar {
            width: 290px;
            background-image: url('https://i.imgur.com/bNRxAhZ.png');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 20px;
            height: 100vh;
            position: fixed;
            transition: transform 0.3s ease;
        }

        .sidebar h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .sidebar ul {
            list-style-type: none;
            padding: 0;
        }

        .sidebar ul li {
            margin: 50px 0;
        }

        .sidebar ul li a {
            color: white;
            text-decoration: none;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar ul li a img {
            width: 30px;
            height: 30px;
        }

        .sidebar ul li a:not(.dark-theme-label a) {
            transition: all 0.3s ease;
            position: relative;
        }

        .sidebar ul li a:not(.dark-theme-label a):hover {
            color: #d7b15c;
            transform: translateX(5px);
        }

        .sidebar ul li a:not(.dark-theme-label a)::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -10px;
            left: 0;
            background-color: #d7b15c;
            transition: width 0.3s ease;
        }

        .sidebar ul li a:not(.dark-theme-label a):hover::after {
            width: 95%;
        }

        .dark-theme .sidebar ul li a:not(.dark-theme-label a):hover {
            color: #d7b15c;
        }

        .dark-theme-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 20px;
        }

        .dark-theme-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
        }

        .dark-theme-label img {
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .switch-label {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #28292c;
            border-radius: 25px;
            cursor: pointer;
            border: 3px solid #28292c;
        }

        .checkbox {
            position: absolute;
            display: none;
        }

        .slider {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 25px;
            transition: 0.3s;
        }

        .checkbox:checked ~ .slider {
            background-color: #d8dbe0;
        }

        .slider::before {
            content: "";
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            box-shadow: inset 8px -3px 0px 0px #d8dbe0;
            background-color: #28292c;
            transition: 0.3s;
        }

        .checkbox:checked ~ .slider::before {
            transform: translateX(30px);
            background-color: #28292c;
            box-shadow: none;
        }

        .content {
            flex: 1;
            margin-left: 290px;
            padding: 0 30px 15px;
            position: relative;
            transition: background-color 0.3s ease, margin-left 0.3s ease;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(247, 247, 247, 0.9);
            z-index: 0;
            transition: background-color 0.3s ease;
        }

        .dark-theme .content {
            background-color: #28292c;
        }

        .dark-theme .content::before {
            background-color: rgba(40, 41, 44, 0.9);
        }

        .header {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 20px;
            position: relative;
            z-index: 3000;
        }

        .account-customization {
            position: fixed;
            top: 10px;
            right: 20px;
            z-index: 3001;
        }

        .user-details {
            display: none;
        }

        .avatar-container {
            position: relative;
            display: inline-block;
        }

        .avatar-container .profile-pic {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #ccc;
            display: flex;
            justify-content: center;
            align-items: center;
            object-fit: cover;
            border: 2px solid #000;
            cursor: pointer;
            color: transparent;
            font-size: 0;
        }

        .customization-options {
            position: absolute;
            top: 60px;
            right: 0;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
            flex-direction: column;
            padding: 8px;
            z-index: 3002;
            align-items: flex-start;
            width: 300px;
        }

        .customization-options.active {
            display: flex;
        }

        .customization-options .user-info {
            margin-bottom: 10px;
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #d32f2f 100%);
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }

        .customization-options .user-info::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://www.transparenttextures.com/patterns/circuit.png');
            opacity: 0.1;
            z-index: 0;
        }

        .customization-options .user-info p {
            margin: 5px 0;
            font-size: 12px;
            color: #ffffff;
            position: relative;
            z-index: 1;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            font-weight: 500;
            overflow-wrap: break-word;
        }

        .customization-options .user-info p::before {
            content: attr(data-label);
            font-weight: 700;
            color: #ff3333;
            margin-right: 5px;
        }

        .customization-options label {
            font-size: 12px;
            color: #333;
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px 8px;
            transition: background-color 0.3s ease;
            width: 100%;
            text-align: left;
        }

        .customization-options label:hover {
            background-color: #f0f0f0;
            border-radius: 5px;
        }

        .customization-options input[type="color"] {
            width: 100%;
            height: 25px;
            padding: 0;
            border: none;
            cursor: pointer;
            background: none;
        }

        .customization-options select {
            font-size: 12px;
            padding: 4px;
            border-radius: 5px;
            border: 1px solid #ccc;
            cursor: pointer;
            width: 100%;
        }

        .customization-options input[type="file"] {
            display: none;
        }

        .customization-options .file-input-label {
            font-size: 12px;
            color: #333;
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px 8px;
            transition: background-color 0.3s ease;
            width: 100%;
            text-align: left;
        }

        .customization-options .file-input-label:hover {
            background-color: #f0f0f0;
            border-radius: 5px;
        }

        .dark-theme .customization-options {
            background-color: #3a3b3c;
            border-color: #555;
        }

        .dark-theme .customization-options .user-info {
            background: linear-gradient(135deg, #5a6268 0%, #454b50 50%, #2f3539 100%);
            color: #e0e0e0;
        }

        .dark-theme .customization-options .user-info p {
            color: #e0e0e0;
        }

        .dark-theme .customization-options .user-info p::before {
            color: #ffeb3b;
        }

        .dark-theme .customization-options label,
        .dark-theme .customization-options .file-input-label {
            color: #e0e0e0;
        }

        .dark-theme .customization-options label:hover,
        .dark-theme .customization-options .file-input-label:hover {
            background-color: #4a4b4c;
        }

        .dark-theme .customization-options select {
            background-color: #3a3b3c;
            color: #e0e0e0;
            border-color: #555;
        }

        .saved-laws-section {
            flex: 1;
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            padding: 20px 0;
        }

        .saved-laws-header {
        display: flex;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap; 
        gap: 20px; 
        justify-content: flex-start;
        }

        .saved-laws-title {
        font-size: 28px;
        font-weight: 700;
        margin: 0;
        color: #2d3748;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        position: relative;
        order: 0;
        }

        .saved-laws-title::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 50px;
            height: 3px;
            background-color: #d7b15c;
        }

        .dark-theme .saved-laws-title {
            color: #e2e8f0;
        }

        .dark-theme .saved-laws-title::after {
            background-color: #ecc94b;
        }

        .clear-all-btn {
            background-color: #c53030;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            order: 1;
            }

            .clear-all-btn:hover {
            background-color: #a12626;
            transform: scale(1.05);
            }

            .clear-all-btn:active {
            transform: scale(0.95);
            }

            .dark-theme .clear-all-btn {
            background-color: #9b2c2c;
            }

            .dark-theme .clear-all-btn:hover {
            background-color: #7f2525;
            }

            .saved-laws-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            padding: 0;
            margin: 0;
            }

            .saved-law-item {
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05), 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            }

            .saved-law-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.15);
            }

            .dark-theme .saved-law-item {
            background-color: #2d3748;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3), 0 1px 3px rgba(0, 0, 0, 0.4);
            }

            .dark-theme .saved-law-item:hover {
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4), 0 2px 4px rgba(0, 0, 0, 0.5);
            }

            .saved-law-image {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-bottom: 3px solid #d7b15c;
            }

            .dark-theme .saved-law-image {
            border-bottom-color: #ecc94b;
            }

            .saved-law-content {
            padding: 15px;
            flex: 1;
            display: flex;
            flex-direction: column;
            }

            .saved-law-title {
            font-size: 16px;
            font-weight: 600;
            color: #2d3748;
            margin: 0 0 8px;
            text-align: center;
            }

            .dark-theme .saved-law-title {
            color: #e2e8f0;
            }

            .saved-law-timestamp {
            font-size: 12px;
            color: #718096;
            margin: 0 0 12px;
            text-align: center;
            }

            .dark-theme .saved-law-timestamp {
            color: #a0aec0;
            }

            .saved-law-actions {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: auto;
            }

            .action-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            }

            .download-btn {
            background-color: #d7b15c;
            color: white;
            }

            .download-btn:hover {
            background-color: #b8973e;
            transform: scale(1.1);
            }

            .download-btn:active {
            transform: scale(0.95);
            }

            .dark-theme .download-btn {
            background-color: #ecc94b;
            }

            .dark-theme .download-btn:hover {
            background-color: #d4b038;
            }

            .delete-btn {
            background-color: #e53e3e;
            color: white;
            }

            .delete-btn:hover {
            background-color: #c53030;
            transform: scale(1.1);
            }

            .delete-btn:active {
            transform: scale(0.95);
            }

            .dark-theme .delete-btn {
            background-color: #f56565;
            }

            .dark-theme .delete-btn:hover {
            background-color: #db4949;
            }

            .action-btn i {
            font-size: 16px;
            }

            .no-saved-laws {
            text-align: center;
            font-size: 16px;
            font-weight: 500;
            color: #718096;
            margin-top: 40px;
            background-color: #edf2f7;
            padding: 20px;
            border-radius: 10px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
            }

            .dark-theme .no-saved-laws {
            color: #a0aec0;
            background-color: #2d3748;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
            }

            footer {
            background-color: #333;
            color: white;
            padding: 15px 30px;
            text-align: center;
            margin-left: 290px;
            z-index: 1;
            transition: margin-left 0.3s ease;
            }

            footer p {
            margin: 0;
            font-size: 14px;
            }

            .footer-links {
            margin-top: 5px;
            }

            .footer-links a {
            color: #d7b15c;
            text-decoration: none;
            margin: 0 10px;
            font-size: 14px;
            }

            .footer-links a:hover {
            text-decoration: underline;
            }

            .dark-theme footer {
            background-color: #1a1a1a;
            }

            .mobile-nav {
            display: none;
            background-image: url('https://i.imgur.com/bNRxAhZ.png');
            padding: 15px;
            position: fixed;
            width: 100%;
            z-index: 3000;
            }

            .mobile-nav .logo {
            color: white;
            font-size: 20px;
            font-weight: bold;
            text-decoration: none;
            }

            .mobile-nav .menu-icon {
            color: white;
            font-size: 24px;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 15px;
            }

            @media (max-width: 1024px) {
            .sidebar {
            width: 250px;
            }

            .sidebar h1 {
            font-size: 22px;
            }

            .sidebar ul li a {
            font-size: 16px;
            }

            .dark-theme-label {
            font-size: 16px;
            }

            .content {
            margin-left: 250px;
            }

            footer {
            margin-left: 250px;
            }

            .account-customization {
            right: 10px;
            }

            .avatar-container .profile-pic {
            width: 35px;
            height: 35px;
            }

            .avatar-loading {
            width: 35px;
            height: 35px;
            }

            .avatar-loading .loader {
            width: 18px;
            height: 18px;
            border-width: 2px;
            }

            .customization-options {
            top: 45px;
            width: 220px;
            }

            .saved-laws-title {
            font-size: 24px;
            }

            .saved-law-item {
            min-height: 280px;
            }

            .saved-law-image {
            height: 120px;
            }

            .saved-law-title {
            font-size: 14px;
            }

            .saved-law-timestamp {
            font-size: 11px;
            }

            .action-btn {
            width: 36px;
            height: 36px;
            }

            .action-btn i {
            font-size: 14px;
            }

            .clear-all-btn {
            padding: 6px 12px;
            font-size: 13px;
            }
            }

        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
                padding: 10px;
            }

            .sidebar h1 {
                font-size: 20px;
            }

            .sidebar ul li a {
                font-size: 14px;
            }

            .dark-theme-label {
                font-size: 14px;
            }

            .content {
                margin-left: 200px;
                padding: 20px;
            }

            .avatar-container .profile-pic {
                width: 30px;
                height: 30px;
            }

            .avatar-loading {
                width: 30px;
                height: 30px;
            }

            .avatar-loading .loader {
                width: 15px;
                height: 15px;
                border-width: 2px;
            }

            .customization-options {
                top: 40px;
                width: 200px;
            }

            footer {
                margin-left: 200px;
            }

            .saved-laws-title {
                font-size: 22px;
            }

            .saved-law-item {
                min-height: 260px;
            }

            .saved-law-image {
                height: 110px;
            }

            .clear-all-btn {
                padding: 5px 10px;
                font-size: 12px;
            }
        }

        @media (max-width: 480px) {
            .container {
                flex-direction: column;
            }

            .mobile-nav {
                display: block;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: fixed;
                padding: 10px;
                transform: translateX(-100%);
                z-index: 2999;
                top: 60px;
                height: calc(100vh - 60px);
                overflow-y: auto;
            }

            .sidebar.active {
                transform: translateX(0);
                z-index: 3000;
            }

            .sidebar h1 {
                display: none;
            }

            .sidebar ul li {
                margin: 20px 0;
            }

            .sidebar ul li a {
                font-size: 16px;
            }

            .dark-theme-label {
                font-size: 16px;
            }

            .content {
                margin-left: 0;
                padding: 80px 15px 15px;
            }

            .header {
                justify-content: center;
            }

            footer {
                margin-left: 0;
                padding: 10px 20px;
                text-align: center;
            }

            footer p {
                font-size: 12px;
            }

            .footer-links a {
                font-size: 12px;
                margin: 0 8px;
            }

            .account-customization {
                top: 15px;
                right: 55px;
                z-index: 3001;
            }

            .avatar-container .profile-pic {
                width: 30px;
                height: 30px;
                border-width: 1px;
            }

            .avatar-loading {
                width: 30px;
                height: 30px;
            }

            .avatar-loading .loader {
                width: 15px;
                height: 15px;
                border-width: 2px;
            }

            .customization-options {
                top: 40px;
                width: 180px;
                z-index: 3002;
            }

            .customization-options .user-info p {
                font-size: 10px;
            }

            .customization-options label,
            .customization-options .file-input-label {
                font-size: 10px;
                padding: 3px 6px;
            }

            .customization-options select {
                font-size: 10px;
                padding: 3px;
            }

            .saved-laws-title {
                font-size: 20px;
            }

            .saved-law-item {
                min-height: 240px;
            }

            .saved-law-image {
                height: 100px;
            }

            .saved-law-title {
                font-size: 13px;
            }

            .saved-law-timestamp {
                font-size: 10px;
            }

            .action-btn {
                width: 32px;
                height: 32px;
            }

            .action-btn i {
                font-size: 13px;
            }

            .saved-laws-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                gap: 15px;
            }

            .clear-all-btn {
                padding: 4px 8px;
                font-size: 11px;
            }
        }
    </style>
</head>
<body>
    <div class="loader-overlay" id="loaderOverlay">
        <div class="loader"></div>
    </div>
    <div class="mobile-nav">
        <a href="#" class="logo">Contra E-Crime</a>
        <div class="menu-icon" id="mobileMenuIcon">
            <i class="fas fa-bars"></i>
        </div>
    </div>

    <div class="container">
        <nav class="sidebar" id="sidebar">
            <h1>Contra E-Crime</h1>
            <ul>
                <li>
                    <a href="HomePage.html">
                        <img src="https://i.imgur.com/OAHusQp.png" alt="Home">
                        Home
                    </a>
                </li>
                <li>
                    <a href="News.html">
                        <img src="https://i.imgur.com/FNALwXX.png" alt="News & Insights">
                        News & Insights
                    </a>
                </li>
                <li>
                    <a href="SavedLaws.html">
                        <img src="https://i.imgur.com/VChoqhD.png" alt="Saved Laws">
                        Saved Laws
                    </a>
                </li>
                <li>
                    <a href="History.html">
                        <img src="https://i.imgur.com/cnaDfEq.png" alt="Search History">
                        Search History
                    </a>
                </li>
                <li>
                    <a href="ContactUs.html">
                        <img src="https://i.imgur.com/T7bI4RJ.png" alt="Contact Us">
                        Contact Us
                    </a>
                </li>
                <li>
                    <a href="AboutUs.html">
                        <img src="https://i.imgur.com/lktrzpa.png" alt="About Us">
                        About Us
                    </a>
                </li>
                <li>
                    <a href="index.html">
                        <img src="https://i.imgur.com/2jjsgOq.png" alt="Logout">
                        Logout
                    </a>
                </li>
            </ul>
            <div class="dark-theme-container">
                <div class="dark-theme-label">
                    <img src="https://i.imgur.com/vEKpOsq.png" alt="Dark Theme">
                    <span>Dark Theme</span>
                </div>
                <div class="toggle-switch">
                    <label class="switch-label">
                        <input type="checkbox" class="checkbox" id="themeToggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </nav>
        <main class="content">
            <header class="header">
                <div class="account-customization">
                    <div class="user-details"></div>
                    <div class="avatar-container">
                        <img class="profile-pic" id="profilePic" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/4L1mGQAAAAASUVORK5CYII=" alt="User Avatar">
                        <div class="avatar-loading" id="avatarLoading">
                            <div class="loader"></div>
                        </div>
                        <div class="customization-options" id="customizationMenu">
                            <div class="user-info" id="userInfo">
                                <p id="usernameDisplay" data-label="Username:">Loading...</p>
                                <p id="emailDisplay" data-label="Email:">Loading...</p>
                                <p id="createdAtDisplay" data-label="Account Created:">Loading...</p>
                            </div>
                            <label class="file-input-label" for="avatarInput">Change Avatar</label>
                            <input type="file" id="avatarInput" accept="image/jpeg,image/png,image/jpg">
                            <label for="avatarBgColorPicker">Avatar Background Color</label>
                            <input type="color" id="avatarBgColorPicker" value="#cccccc">
                            <label for="borderColorPicker">Border Color</label>
                            <input type="color" id="borderColorPicker" value="#000000">
                            <label for="borderTypeSelect">Border Type</label>
                            <select id="borderTypeSelect">
                                <option value="solid">Solid</option>
                                <option value="dashed">Dashed</option>
                                <option value="dotted">Dotted</option>
                                <option value="double">Double</option>
                            </select>
                        </div>
                    </div>
                </div>
            </header>
            <section class="saved-laws-section">
                <div class="saved-laws-header">
                    <h2 class="saved-laws-title">Saved Legal Bookmarks</h2>
                    <button class="clear-all-btn" id="clearAllBtn">
                        <i class="fas fa-trash-alt"></i> Clear All History
                    </button>
                </div>
                <div class="saved-laws-grid" id="savedLawsGrid"></div>
            </section>
        </main>
        <footer>
            <p>© 2025 Contra E-Crime. All rights reserved.</p>
            <div class="footer-links">
                <a href="PrivacyPolicy.html">Privacy Policy</a>
                <a href="TermsOfUse.html">Terms of Use</a>
                <a href="ContactUs.html">Contact Us</a>
            </div>
        </footer>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCDNmxNOV7rr_qfM_mTeYTaUIkkLvRaf80",
            authDomain: "contra-e-crime.firebaseapp.com",
            projectId: "contra-e-crime",
            storageBucket: "contra-e-crime.firebasestorage.app",
            messagingSenderId: "198995444405",
            appId: "1:198995444405:web:5f8c6eed561461b36034fc",
            databaseURL: "https://contra-e-crime-default-rtdb.firebaseio.com"
        };

        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        const CLOUDINARY_CLOUD_NAME = 'dkxtbukta';
        const CLOUDINARY_UPLOAD_PRESET = 'contraecrime';

        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;
        const mobileMenuIcon = document.getElementById('mobileMenuIcon');
        const sidebar = document.getElementById('sidebar');
        const loaderOverlay = document.getElementById('loaderOverlay');
        const profilePic = document.getElementById('profilePic');
        const customizationMenu = document.getElementById('customizationMenu');
        const avatarInput = document.getElementById('avatarInput');
        const avatarLoading = document.getElementById('avatarLoading');
        const avatarBgColorPicker = document.getElementById('avatarBgColorPicker');
        const borderColorPicker = document.getElementById('borderColorPicker');
        const borderTypeSelect = document.getElementById('borderTypeSelect');
        const usernameDisplay = document.getElementById('usernameDisplay');
        const emailDisplay = document.getElementById('emailDisplay');
        const createdAtDisplay = document.getElementById('createdAtDisplay');
        const savedLawsGrid = document.getElementById('savedLawsGrid');
        const clearAllBtn = document.getElementById('clearAllBtn');
        const laws = [
    {
        title: "Intellectual Property Code of the Philippines (Republic Act No. 8293)",
        description: "A law that protects and enforces the rights of creators and owners of intellectual property, including copyrights, trademarks, patents, and industrial designs.",
        scenario: "A business using a copyrighted song in its marketing materials without permission from the copyright holder.",
        punishment: "For the first offense: The penalty is imprisonment of one to three years and a fine ranging from PhP 50,000 to PhP 150,000. For the second offense: The penalty increases to imprisonment of three years and one day to six years, along with a fine of PhP 150,000 to PhP 500,000. For third and subsequent offenses: The most severe penalty is imprisonment of six years and one day to nine years, and a fine ranging from PhP 500,000 to PhP 1,500,000. In cases of insolvency, additional subsidiary imprisonment may be imposed.",
        image: "https://newsline.ph/wp-content/uploads/2024/10/IPO.jpg",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/2/4371"
    },
    {
        title: "Terrorism Financing Prevention and Suppression Act (Republic Act No. 10168)",
        description: "A law that criminalizes the financing of terrorism and related offenses, aiming to prevent and suppress such acts by freezing and forfeiting associated properties or funds. It also aims to protect life, liberty, and property from terrorism.",
        scenario: "Could involve a group of individuals using a legitimate business to funnel funds to terrorist organizations.",
        punishment: "Individuals involved in financing terrorism results in imprisonment penalty ranges from reclusion temporal (maximum period) to reclusion perpetua, with fines ranging from Php 500,000.00 to Php 1,000,000.00. Those attempting to commit the crime will receive a penalty two degrees lower than the actual crime, while conspirators face the same penalty as the principal offenders. Accomplices receive a penalty one degree lower than that of the conspirators. The Anti-Money Laundering Council (AMLC) has the authority to impose administrative penalties, including reprimands or fines from Php 100,000 to Php 500,000, for violations of the law or its rules. The law permits the freezing and forfeiture of property or funds involved in terrorism financing.",
        image: "https://api.phkule.org/storage/photos/mLOPcQRdubQOvWmnMTqX0mUMYlawV5eXGY4EqyEl.png",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/2/37689"
    },
    {
        title: "Anti-Money Laundering Act of 2001 (Republic Act No. 9160)",
        description: "A law that defines and criminalizes money laundering, aiming to prevent the use of the country's financial system for laundering the proceeds of illegal activities. It also includes provisions for asset freezing and international cooperation in combating money laundering.",
        scenario: "A criminal who gains a large sum of money from drug trafficking (a predicate crime). To launder this money, He might deposit the cash into a legitimate business account, then use that business account to purchase real estate and other assets.",
        punishment: "A person who knowingly transacts or attempts to transact monetary instruments or property related to unlawful activity may face 7 to 14 years of imprisonment and a fine of at least ₱3,000,000 or up to twice the value of the asset involved. If someone facilitates such transactions by action or inaction, they may be punished with 4 to 7 years of imprisonment and a fine ranging from ₱1,500,000 to ₱3,000,000. Failure to disclose or file required information with the Anti-Money Laundering Council (AMLC) may result in 6 months to 4 years of imprisonment and a fine between ₱100,000 and ₱500,000, or both. Failure to keep records is punishable by 6 months to 1 year of imprisonment or a fine of ₱100,000 to ₱500,000, or both. Malicious or false reporting related to money laundering may lead to 6 months to 4 years of imprisonment and a fine within the same range, without eligibility for probation. Responsible officers of corporations or organizations involved may also be penalized, and additional sanctions apply to aliens (deportation), public officials (disqualification), and those who refuse to testify. Breach of confidentiality carries a penalty of 3 to 8 years of imprisonment and a fine of ₱500,000 to ₱1,000,000.",
        image: "https://bitpinas.com/wp-content/uploads/2017/11/anti-money-laundering-3.png",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/10/44124"
    },
    {
        title: "National Bureau of Investigation Reorganization Act (Republic Act No. 10867)",
        description: "This law aims to enhance the NBI's investigative capabilities by reorganizing and modernizing the agency. It establishes a clear structure, expands the NBI's powers and functions, and sets qualification standards for personnel. The Act also provides for funding and transition provisions to ensure continuity.",
        scenario: "The NBI Cybercrime Division conducted a raid on a group operating a phishing scam, where suspects created fake websites that mimicked legitimate online banking portals.",
        punishment: "No specific punishments are outlined in the law for violations, as it primarily focuses on reorganizing and empowering the NBI.",
        image: "https://assistance.ph/wp-content/uploads/2023/12/nbi.jpg",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/2/67908"
    },
    {
        title: "Mobile Number Portability Act (Republic Act No. 11202)",
        description: "This law allows mobile subscribers to switch telecommunications service providers while keeping their existing mobile numbers. This act promotes consumer welfare by allowing consumers to freely choose and switch providers without losing their phone number.",
        scenario: "A person could port a number known to be associated with a legitimate business or individual to create a false identity, potentially for scams, identity theft, or other illegal activities.",
        punishment: "An initial fine of ₱10,000 is imposed if number portability is not completed within the prescribed time frame but is eventually delivered either before a complaint is filed or after mediation. Where a telecommunications provider unjustly refuses to perform portability even after mediation, fines ranging from ₱40,000 to ₱1,000,000 may be imposed. For repeated offenses—specifically on the fifth and subsequent instances of unjust refusal after mediation—the penalties are ranging from ₱400,000 to ₱1,000,000 and the possible revocation of the Public Telecommunications Entity (PTE) franchise.",
        image: "https://static.tripzilla.ph/media/102907/conversions/mobile-number-portability-2-w768.webp",
        pdf: ""
    },
    {
        title: "Safe Spaces Act (Republic Act No. 11313)",
        description: "A law enacted to protect individuals from gender-based sexual harassment in public spaces, online, workplaces, and educational institutions. It defines and penalizes various forms of gender-based sexual harassment in these settings.",
        scenario: "A person receives inappropriate, sexual messages from someone in a group chat, despite not expressing interest.",
        punishment: "Verbal harassment such as cursing, wolf-whistling, catcalling, and sexist or homophobic slurs. The first offense results in a ₱1,000 fine and 12 hours of community service, including attending a Gender Sensitivity Seminar. The second offense is by 6 to 10 days of imprisonment or a ₱3,000 fine, while the third offense carries 11 to 30 days of imprisonment and a ₱10,000 fine. Lewd acts like offensive body gestures, flashing, public masturbation, or groping. The first offense results in a ₱10,000 fine and 12 hours of community service with a Gender Sensitivity Seminar. The second offense carries 11 to 30 days of imprisonment or a ₱15,000 fine, the third offense results in 1 month and 1 day to 6 months of imprisonment and a ₱20,000 fine. Stalking or unwanted physical contact such as pinching, brushing, or touching private areas.the first offense is punishable by 11 to 30 days of imprisonment or a ₱30,000 fine, along with a Gender Sensitivity Seminar. The second offense carries 1 month and 1 day to 6 months of imprisonment or a ₱50,000 fine, the third offense results in a maximum of 6 months imprisonment or a ₱100,000 fine.",
        image: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEirkYMjV2TfdB0Bow9Ogb4SrlNynpEH1ZLrRa6JImmu5cBs80cBzVCc9ctM1O69ly9pDLg08qk2185e2z9uNueciTzn0dnBsuK2BD1V4GWDHPwTdjBTSbgisQrJfbmHcLh6zB9s7zRSG7y_IZu-Cx7eQCr451ep8cN5hR2Ab6wmC5IRLYjeK23EiQ/w640-h360/Tara%20Kape!%20(SITE)%20(4).png",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/2/96805"
    },
    {
        title: "New Central Bank Act (Republic Act No. 7653)",
        description: "The country's central monetary authority. It mandates the BSP to maintain price stability and promote financial stability, while also providing for fiscal and administrative autonomy. The act also outlines the structure and powers of the Monetary Board, including its membership and responsibilities.",
        scenario: "Could involve a bank director or officer engaging in a conflict of interest by taking a loan from the bank they oversee, without disclosing it to the Monetary Board, or violating the confidentiality of bank deposits by revealing information obtained during supervision.",
        punishment: "Unauthorized issuance of Bangko Sentral notes or reproduction of their facsimiles is punishable by imprisonment not less than five (5) years but not more than ten (10) years. Making false statements to the Monetary Board or Bangko Sentral examiners can lead to fines of up to ₱2 million, imprisonment for up to 5 years, or both. Violating BSP regulations can result in imprisonment of not less than 5 years but not more than 10 years, or a greater penalty under the Revised Penal Code. Maliciously reporting or filing false information leading to the temporary holding of funds is punishable under the Act. Fraudulently overvaluing property or making false statements in loan applications can lead to imprisonment ranging from six months to four years and a fine of not less than ₱100,000 and in some cases, up to ₱500,000 pesos. Unauthorized disclosure of confidential BSP information can result in a fine of not less than ₱100,000 and not more than ₱200,000, or imprisonment of a maximum of 14 years. The Monetary Board can impose ₱30,000 to ₱1,000,000 fines for non-compliance and take action on unlawful or unsafe operations.",
        image: "https://cdn.slidesharecdn.com/ss_thumbnails/bsp-banking-law-150818155013-lva1-app6891-thumbnail.jpg?width=560&fit=bounds",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/2/2027"
    },
    {
        title: "Anti-Wire Tapping Act (Republic Act No. 4200)",
        description: "The law prohibits and penalizes unauthorized wiretapping and other related violations of communication privacy. It makes it illegal to tap wires or cables, secretly overhear, intercept, or record communications or spoken words, and possess recordings of such actions without consent from all parties involved.",
        scenario: "Involves a confidential business meeting where a person secretly records the conversation using a dictaphone without the knowledge or consent of the other participants.",
        punishment: "Imprisonment for 6 months to 6 years, and perpetual disqualification from public office if the offender is a public official at the time of the offense. Additionally, if the offender is an alien, they can face deportation proceedings after serving their sentence.",
        image: "https://philippinelawfirm.com/wp-content/uploads/2023/10/gen12-wiretapping_2018-12-02_21-43-46.jpg",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/2/4442"
    },
    {
        title: "Human Security Act of 2007 (Republic Act No. 9372)",
        description: "This law aimed to protect the Philippines from terrorism by defining the crime and providing mechanisms for its prevention and suppression. The act declared its state policy to protect life, liberty, and property from acts of terrorism and to address the issue through a comprehensive approach encompassing legal, political, economic, diplomatic, and military means.",
        scenario: "Could involve a bomb threat reported at a crowded public event, leading to the arrest and detention of a suspect based on the law's provisions.",
        punishment: "Joining a proscribed organization or one formed for terrorism purposes is punishable by 12 years of imprisonment. Assisting terrorists, such as harboring or aiding in the escape of a terrorist conspirator, carries a penalty of 10 years and one day to 12 years of imprisonment. Attempted terrorism is penalized two degrees lower than the penalty for the full crime, while conspiracy to commit terrorism is punished the same as the crime itself. Foreign terrorists committing acts of terrorism face life imprisonment without parole. Conspiring to commit terrorism also results in life imprisonment without parole. Police or law enforcement officials who fail to notify individuals of the termination of surveillance, interception, or recording activities face imprisonment of 10 years and one day to 12 years.",
        image: "https://media.philstar.com/images/articles/marawi-clashes_2018-02-07_15-04-35.jpg",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/2/5340"
    },
    {
        title: "Anti-Terrorism Act of 2020 (Republic Act No. 11449)",
        description: "A law in the Philippines aimed at preventing, prohibiting, and penalizing terrorism. It defines terrorism and related offenses, outlines the powers and functions of the Anti-Terrorism Council (ATC), and provides for the detention and surveillance of suspected terrorists. The law also addresses the financing of terrorism and the forfeiture of assets.",
        scenario: "Could involve individuals or groups who, with the intent to intimidate the public or government, release dangerous substances or cause fire, floods, or explosion.",
        punishment: "Terrorism is punishable by life imprisonment without parole, along with a fine ranging from one million pesos (₱1,000,000.00) to five million pesos (₱5,000,000.00). Attempting to commit terrorism carries the same penalty as the completed act, including life imprisonment without parole. Conspiracy to commit terrorism is also penalized with the same sentence as the completed crime. Financing terrorism results in reclusion temporal (maximum period) to reclusion perpetua, and a fine between five hundred thousand pesos (₱500,000.00) and one million pesos (₱1,000,000.00). An accomplice in terrorism financing faces a penalty one degree lower than the conspirator. Economic sabotage related to terrorism is punishable by life imprisonment and a fine between one million pesos (₱1,000,000.00) and five million pesos (₱5,000,000.00). Other violations are punishable by imprisonment ranging from 10 to 20 years, with fines ranging from ₱500,000 to ₱800,000, depending on the offense's severity.",
        image: "https://files01.pna.gov.ph/category-list/2020/07/07/anti-terror-law.jpg",
        pdf: "https://elibrary.judiciary.gov.ph/thebookshelf/showdocsfriendly/2/92597"
    },
    {
        title: "Anti-Bullying Act of 2013 (Republic Act No. 10627)",
        description: "Schools are required to implement policies to prevent and address bullying within their institutions and set procedures for handling complaints. It defines bullying as any severe or repeated use of written, verbal, or physical acts or gestures directed at another student that causes fear or disrupts the education process. The law also outlines reporting requirements and sanctions for non-compliance.",
        scenario: "An elementary student teased by his classmates because of how they do not like his penmanship. They always distract him by writing anything in his notebook while he takes note of their lessons peacefully.",
        punishment: "School Employees: A fine of 50,000 to 100,000 pesos or imprisonment from 6 months to 1 year, or both, for bullying. Private Schools: Suspension or revocation of their permits to operate for non-compliance. Public School Personnel: Subject to administrative disciplinary proceedings under Civil Service or Department rules. Private School Personnel: Subject to administrative disciplinary actions imposed by the school.",
        image: "https://images.app.goo.gl/HPxWVGGP1gTZnfpc6",
        pdf: "https://elegal.ph/site/wp-content/uploads/2015/07/RA-10627.pdf"
    },
    {
        title: "Department of Information and Communications Technology Act (Republic Act No. 10844)",
        description: "It establishes the Department of Information and Communications Technology (DICT) as the primary government agency for developing and implementing ICT policies, plans, and programs. To provide oversight over agencies governing and regulating the ICT' sector and ensure consumer protection and welfare, data privacy and security, foster competition and the growth of the ICT sector.",
        scenario: "A local government unit in Fairview, Quezon City, is experiencing a surge in phishing attacks targeting its employees and online services. This poses a risk to public safety and the confidentiality of citizen data.",
        punishment: "Penalties for unauthorized processing of personal data include imprisonment (3-6 years) and fines (Php 500,000 to Php 4,000,000). Penalties for cybercrime vary depending on the offense and can include imprisonment and fines.",
        image: "https://images.app.goo.gl/63vCtVZjWfn9ENr28",
        pdf: "https://cms-cdn.e.gov.ph/DICT/pdf/RA10844_DICT.pdf"
    },
    {
        title: "Strategic Trade Management Act (Republic Act No. 10697)",
        description: "An Act Preventing the Proliferation of Weapons of Mass Destruction by Managing the Trade in Strategic Goods, the Provision of Related Services, and for Other Purposes.",
        scenario: "A company in the Philippines, X Corp, wants to export a high-speed computer chip to a foreign country, but the chip is also listed as a dual-use good, meaning it could be used for both civilian and military applications.",
        punishment: "Up to P250,000 or twice the value of the strategic good. Upon request from the Securities and Exchange Commission (SEC), Department of Trade and Industry (DTI), or other relevant agencies, the STMO can order the suspension or cancellation of a business's registration and authorization. Violations can lead to imprisonment ranging from six months to twelve years, depending on the severity.",
        image: "https://images.app.goo.gl/LzxspNHJEgFpxohn7",
        pdf: "https://233773342789-lic.s3.eu-central-1.amazonaws.com/attachments/legislation/philippines/Implementing%20Rules%20of%20the%20Strategic%20Trade%20Management%20Act_25.09.2018.pdf"
    },
    {
        title: "Energy Virtual One-Stop Shop Act (Republic Act No. 11234)",
        description: "A web-based filing and monitoring system for energy related applications and a repository of information and permits issued for energy projects.",
        scenario: "A company seeking to build a solar power plant, would use EVOSS to submit all necessary documents and track the progress of its application with various agencies.",
        punishment: "A fine of One hundred thousand pesos (₱100,000.00) for every day of delay.",
        image: "https://images.app.goo.gl/K1QNfksaXf2FFqPx7",
        pdf: "https://evoss.ph/Home/Download/135253"
    },
    {
        title: "Consumer Act of the Philippines (Republic Act No. 7394)",
        description: "The primary law governing consumer protection in the country. It aims to protect consumers from health and safety hazards, deceptive practices, and unfair sales. It also provides for consumer education and redress mechanisms, and includes consumer representatives in policy formulation.",
        scenario: "Involves a consumer purchasing a product with a 'No Return, No Exchange' policy, only to discover it has a manufacturing defect. In this case, the consumer has the right to have the product repaired, replaced, or refunded, despite the store's policy, as the defect falls under the Consumer Act's protection.",
        punishment: "Title III,Chapter I (Deceptive, Unfair, and Unconscionable Sales Acts): Fines range from PHP 500 to PHP 10,000 or imprisonment of 5 months to 1 years, or both. Article 64 (Violations related to weights and measures): Fines range from PHP 50,000 to PHP 300,000 or imprisonment of 1 year to 5 years, or both. Article 18 (Prohibited Acts): Fines range from PHP 1,000 to PHP 10,000 or imprisonment of 2 months to 1 year, or both.",
        image: "https://images.app.goo.gl/1FYipzHQygJ1DYU19",
        pdf: "https://aseanconsumer.org/file/pdf_file/Republic%20Act%20No.%207394%20-%20The%20Consumer%20Act%20of%201992.pdf"
    },
    {
        title: "Optical Media Act of 2003 (Republic Act No. 9239)",
        description: "It is hereby declared to be the policy of the State to ensure the protection and promotion of intellectual property rights. The unregulated mastering, manufacture, replication, importation and exportation of optical media in all forms is inimical to economic growth and public interest.",
        scenario: "A small, unregistered company named 'Copycat Media,' is caught illegally manufacturing and distributing pirated movies and TV shows on DVDs and Blu-rays. They are operating without a license from the OMB, which is required under RA 9239 to engage in these activities.",
        punishment: "Can lead to imprisonment (3-6 years) and a fine of Php 500,000 to Php 1,500,000.",
        image: "https://images.app.goo.gl/qpGKLPRPxvqbE3zE8",
        pdf: "https://www.pntr.gov.ph/wp-content/uploads/2021/04/RA-9239.pdf"
    },
    {
        title: "National Cybersecurity Plan Framework (Executive Order No. 189, 2015)",
        description: "A response to the growing concern about cyber threats and vulnerabilities in the Philippines. About the increasing number of cyber threats and vulnerabilities affecting government and commercial information systems.",
        scenario: "The NCIAC would quickly assess the extent of the attack, identify the source, and determine the impact on critical systems.",
        punishment: "Offenses against confidentiality, integrity, and availability of computer data and systems: Punishable by imprisonment of prision mayor or a fine of at least P200,000 up to a maximum amount commensurate with the damage, or both. Offenses involving misuse of devices: The penalty is a maximum fine of PHP 500,000 and/or imprisonment of prision mayor. Offenses by a juridical person: If committed by a natural person on behalf of a juridical person (with authorization), the juridical person can face a maximum fine of PHP 10,000,000. Specific cybercrime offenses and their potential penalties: Identity theft: Imprisonment of up to 12 years and/or a fine ranging from P50,000 to P500,000. Hacking or unauthorized access: Imprisonment of 6 to 12 years, along with a fine up to P500,000.",
        image: "https://images.app.goo.gl/8bCWhFxQJzQTp3Jh6",
        pdf: "https://cms-cdn.e.gov.ph/DICT/pdf/NCSP-2023-2028-FINAL-DICT.pdf"
    },
    {
        title: "Strengthening DICT’s Cybersecurity Role (Executive Order No. 82, 2022)",
        description: "This plan aims to bolster the country's digital defenses while fostering a culture of cybersecurity awareness and responsibility.",
        scenario: "A government agency fails to implement required cybersecurity measures, leading to a data breach that exposes sensitive citizen information.",
        punishment: "No specific punishments are outlined in the law for violations, as it primarily focuses on establishing the DICT's cybersecurity responsibilities.",
        image: "https://images.app.goo.gl/R8JVMBaQbYLUWYED6",
        pdf: "https://cms-cdn.e.gov.ph/DICT/pdf/NCSP-2023-2028-FINAL-DICT.pdf"
    },
    {
        title: "National Cybersecurity Inter-Agency Committee (Executive Order No. 95, 2019)",
        description: "It was created to strengthen the Philippines’ cybersecurity framework. Its main purpose is to coordinate, integrate, and harmonize all government efforts related to safeguarding the country’s information and communications technology (ICT) infrastructure.",
        scenario: "Its coordination with government agencies to strengthen defenses and respond effectively during cyber threats such as phishing attacks targeting government email systems.",
        punishment: "No specific punishments are outlined in the law for violations, as it primarily focuses on establishing the committee and its coordination role.",
        image: "https://cdn.opengovasia.com/wp-content/uploads/2023/05/PH_2_1270-39.jpg",
        pdf: "https://lawphil.net/executive/execord/eo2019/pdf/eo_95_2019.pdf"
    },
    {
        title: "Guidelines on IT Risk Management (BSP Circular No. 808, 2013)",
        description: "This was designed to strengthen risk management, security operations and IT-related activities, as well as enforce consumer protection regulations in banks and other BSP-supervised institutions.",
        scenario: "When a bank strengthens its online banking system by implementing multi-factor authentication and regularly updating its firewall and antivirus software to manage IT risks and protect customer data from cyber threats.",
        punishment: "Monetary penalties: Fines or other financial sanctions for failing to meet the requirements of the circular. Non-monetary sanctions: Restrictions on operations or management changes. Contractual consequences: Contracts may be deemed void or unenforceable if they are found to violate the circular's provisions.",
        image: "https://images.gmanews.tv/v3/webpics/v3/2015/04/2015_04_17_16_53_36_0.jpg",
        pdf: "https://www.bsp.gov.ph/Regulations/Issuances/2013/c808.pdf"
    },
    {
        title: "Enhanced Information Security Management (BSP Circular No. 982, 2017)",
        description: "It focuses on strengthening data security, requiring BSFIs to establish effective technology risk management processes, governance structures, and cybersecurity controls.",
        scenario: "A bank implemented BSP Circular No. 982 by establishing a robust cybersecurity framework that includes appointing an Information Security Officer, conducting regular risk assessments, and enforcing multi-factor authentication for online transactions.",
        punishment: "Monetary penalties: The BSP can impose fines for non-compliance with the circular's requirements. Suspension or revocation of licenses: A financial institution that consistently fails to comply with information security guidelines may face the risk of its license being suspended or revoked. Action against responsible officers: If a breach of information security is attributable to the actions or negligence of an officer, the BSP may also take action against that individual.",
        image: "https://www.securitymagazine.com/ext/resources/Issues/2019/September/SEC0919-Mobile-Feat-slide1_900px.jpg?1567784812",
        pdf: "https://www.bsp.gov.ph/Regulations/Issuances/2017/c982.pdf"
    },
    {
        title: "Technology and Cyber-Risk Reporting (BSP Circular No. 1019, 2018)",
        description: "This circular aims to strengthen the BSP's cyber-threat surveillance capabilities by tightening the reporting regime for technology and cyber-risk-related incidents and disruptions. It also emphasizes the importance of fostering safe, secure, efficient, and reliable retail payment systems, while protecting customer accounts and information, and upholding consumer protection.",
        scenario: "A financial institution strengthened its cyber-risk oversight by regularly reporting technology-related incidents, identified threats, and corrective actions to senior management for informed decision-making and timely response.",
        punishment: "Monetary penalties: These are outlined in the Manual of Regulations for Banks (MORB) and Manual of Regulations for Non-Bank Financial Institutions (MORNBFI). Suspension of new product offerings: This can restrict the institution's ability to launch new electronic financial products and services. Suspension or revocation of licenses: This can prevent the institution from providing specific financial services or operating entirely. Suspension or revocation of settlement authority: This can impact the institution's ability to participate in the Philippine Payments and Settlements System.",
        image: "https://www.bworldonline.com/wp-content/uploads/2024/10/cybersecurity.jpg",
        pdf: "https://www.bsp.gov.ph/Regulations/Issuances/2018/c1019.pdf"
    },
    {
        title: "Guidelines on Operational Risk Management (BSP Circular No. 900, 2015)",
        description: "Its primary purpose is to ensure the safe and sound operation of BSFIs by promoting the adoption of effective risk management systems. The circular defines operational risk as the risk of loss stemming from inadequate or failed internal processes, people, systems, external events, and legal risk.",
        scenario: "A bank employee accidentally sends a client's confidential financial information to the wrong email address, emphasizing the need for strong data handling procedures to manage operational risks.",
        punishment: "Suspension of rediscounting privileges: Banks may be temporarily suspended from using rediscounting facilities with the BSP. Suspension of cash dividend declaration: Banks may be prohibited from declaring and paying cash dividends. Suspension of branching privileges: Banks may be restricted from opening new branches or expanding their operations. Other Non-Monetary Sanctions: The BSP may also impose other non-monetary sanctions on a case-to-case basis, as determined by the Monetary Board.",
        image: "https://www.riskpro.in/sites/default/files/styles/large/public/Operational%20Risk%20Management_1.jpg?itok=N4UoME9w",
        pdf: "https://rbap.org/wp-content/uploads/2016/01/c900-Guidelines-on-Operational-Risk-Management.pdf"
    },
    {
        title: "Guidelines on Business Continuity Management (BSP Circular No. 951, 2017)",
        description: "It emphasizes the importance of a robust Business Continuity Management process, highlighting the responsibilities of the board of directors and senior management in establishing and promoting a culture that prioritizes business continuity. The circular also specifies the roles and responsibilities of various parties within the organization in implementing and maintaining BCM initiatives.",
        scenario: "A company develops a comprehensive disaster recovery plan to ensure critical operations continue smoothly in the event of a natural disaster, ensuring minimal disruption to services.",
        punishment: "No specific punishments are outlined in the law for violations, as it primarily focuses on establishing guidelines for business continuity.",
        image: "https://www.asisonline.org/globalassets/standards-and-guidelines/bcm-2021/business-continuity-banner-1536px.jpg",
        pdf: "https://www.bsp.gov.ph/Regulations/Issuances/2017/c951.pdf"
    },
    {
        title: "Guidelines on Outsourcing Risk Management (BSP Circular No. 1039, 2019)",
        description: "This circular primarily focuses on the operations and requirements of pawnshops and Money Service Businesses (MSBs), including remittance and transfer companies. It outlines guidelines for the submission of applications for licenses and authorizations for pawnshops, as well as the electronic submission of reports on remittance, money changing, and virtual currency exchange transactions.",
        scenario: "To manage outsourcing risks effectively, a bank conducts thorough assessments of an external service provider’s security protocols and financial health before entrusting them with customer support operations.",
        punishment: "Monetary fines: These are applied for various reporting infractions, such as erroneous, delayed, or unsubmitted reports. Revocation of licenses: In severe cases of non-compliance or repeated violations, the BSP may revoke a pawnshop's or MSB's license to operate.",
        image: "https://resourcecenter.infinit-o.com/wp-content/uploads/2020/01/Infinit-O-Finance-Accounting-Outsourcing-Risk-Management.png",
        pdf: "https://www.bsp.gov.ph/Regulations/Issuances/2019/c1039.pdf"
    },
    {
        title: "Adoption of PNS ISO/IEC 27002 (DICT Memorandum Circular No. 005, 2017)",
        description: "It focuses on the protection of Critical Information Infrastructure (CII) as outlined in the National Cybersecurity Plan (NCSP) 2022. It mandates the adoption of international security standards and outlines policies and regulations for safeguarding CII, as part of the NCSP. This circular also mandates the integration of the National IT Security Policy (NISP) with the NCSP framework.",
        scenario: "A government agency enhances its cybersecurity posture by adopting standardized security protocols and conducting regular risk assessments to protect its ICT systems from potential threats.",
        punishment: "No specific punishments are outlined in the law for violations, as it primarily focuses on adopting international security standards.",
        image: "https://trendsresearch.org/wp-content/uploads/2025/01/Cybersecurity-in-a-World-in-Crisis-V1-copy.jpg",
        pdf: "https://www.scribd.com/document/668954225/Memorandum-Circular-005"
    },
    {
        title: "Protection of Individuals under Cybersecurity Plan (DICT Memorandum Circular No. 007, 2022)",
        description: "This focuses on protecting individuals by promoting cybersecurity awareness and implementing security measures. This includes measures like cybersecurity awareness programs like the CyberSecurity Caravan, and promoting the adoption of cybersecurity practices by individuals. The NCSP aims to enhance the security of critical information infrastructure and government networks, which directly contributes to the protection of individual data and information within these systems.",
        scenario: "A government agency implements a public awareness campaign about online security, teaching citizens how to protect their personal data and avoid falling victim to phishing scams, while also setting up a hotline for individuals to report any cyber incidents they encounter.",
        punishment: "No specific punishments are outlined in the law for violations, as it primarily focuses on promoting cybersecurity awareness.",
        image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQWQ4GS9KMQg29NRva5dGI4sBS_bJBZu_YZkA&s",
        pdf: "https://law.upd.edu.ph/wp-content/uploads/2020/05/DICT-DC-007-2020.pdf"
    },
    {
        title: "Cloud First Policy (DICT Department Circular No. 2017-002)",
        description: "This mandates government agencies to prioritize cloud computing solutions in their IT infrastructure planning and procurement. This policy aims to modernize government operations by leveraging cloud technology while maintaining data control and adhering to security standards.",
        scenario: "The Department of Social Welfare and Development (DSWD) is planning to implement a new online system for managing social welfare programs.",
        punishment: "No specific punishments are outlined in the law for violations, as it primarily focuses on mandating cloud computing adoption.",
        image: "https://elegal.ph/site/wp-content/uploads/2017/02/cloud.jpg",
        pdf: "https://www.jetro.go.jp/ext_images/jetro/activities/support/aseanjapan/report/3-6.pdf"
    },
    {
        title: "Guidelines on Government Email System (DICT Memorandum Circular No. 003, 2020)",
        description: "",
        scenario: "A government employee uses an unauthorized email service to send sensitive official documents, bypassing the secure government email system mandated by the circular.",
        punishment: "No specific punishments are outlined in the law for violations, as it primarily focuses on establishing guidelines for government email use.",
        image: "",
        pdf: ""
    },
    {
        title: "Value-Added Services Regulation (NTC Memorandum Circular No. 02-05-2008)",
        description: "This circular defines Value-Added Services (VAS) as enhanced telecommunications services beyond basic offerings, including messaging, audio/video conferencing, voice mail, electronic mail, information services, and electronic gaming. It outlines registration requirements, service classifications, and regulatory compliance for VAS providers.",
        scenario: "A Voice Over Internet Protocol (VoIP) service provider offering voice calls over the internet, which is not a standard service offered by traditional phone companies.",
        punishment: "Violations of the Circular can lead to revocation or cancellation of registration as a VAS provider.",
        image: "https://images.app.goo.gl/pwhoMYMUUE6MUc5G9",
        pdf: "https://region7.ntc.gov.ph/wp-content/uploads/2024/01/MC_02-05-2008_VAS.pdf"
    },
    {
        title: "Broadcast Messaging Regulation (NTC Memorandum Circular No. 03-03-2005-A)",
        description: "Establishes guidelines for sending broadcast or push messages to subscribers, particularly regarding content providers and public telecommunications entities (PTEs).",
        scenario: "A bank sending promotional text messages to its customers. Without prior consent, this violates the circular, which requires customers to explicitly opt-in to receive such messages.",
        punishment: "Violations range from fines for less than 50 violations to blacklisting and revocation of permits for more than 50 violations per quarter.",
        image: "https://images.app.goo.gl/Fbc63YjxjkrFci5Y6",
        pdf: "https://region7.ntc.gov.ph/wp-content/uploads/2024/01/MC_03-03-2005.pdf"
    },
    {
        title: "Guidelines on Prepaid Load Expiry (NTC Memorandum Circular No. 01-04-2019)",
        description: "Mandating a one-year expiration period for all prepaid loads, regardless of amount. This circular covers all prepaid loads of public telecommunications entities and ICT providers.",
        scenario: "A user named Cleo purchased a Php 100 prepaid load on April 1st, 2025. According to NTC guidelines, the load would expire on April 1st, 2026. If Cleo then purchased another Php 100 load on May 15th, 2025, the new validity period would be calculated from May 15th, 2025, meaning the combined load would expire on May 15th, 2026.",
        punishment: "Violations of these regulations can result in penalties according to the Public Telecommunications Policy Act, the DICT Act of 2015, and other relevant laws, rules, and regulations of the NTC and DICT.",
        image: "https://images.app.goo.gl/hHoAc5rnDu44BBZ87",
        pdf: "https://region7.ntc.gov.ph/wp-content/uploads/2024/01/MC_03-07-2009.pdf"
    },
    {
        title: "Social Media and AI Election Guidelines (COMELEC Resolution No. 11064, 2024)",
        description: "The resolution mandates candidates and political parties to register all digital campaign platforms by 13 December 2024, ensuring compliance with transparency requirements, including disclosing AI usage in campaign materials. The resolution applies to technology platforms and social media companies hosting political content, which must assist in removing unregistered platforms and monitoring for disinformation.",
        scenario: "Use of content produced through AI technology but without compliance with the transparency and disclosure requirements under the resolution.",
        punishment: "Coordinated inauthentic behavior and utilization of hyperactive users for the above mentioned purposes. Creation and dissemination of deep fakes, cheap fakes and soft fakes for the above mentioned purposes. Use of fake and unregistered social media accounts during the election and campaign period for the above mentioned purposes.",
        image: "https://images.app.goo.gl/YTCcpHT2MeTVFfUWA",
        pdf: "https://comelec.gov.ph/php-tpls-attachments/2025NLE/Resolutions/com_res_11064.pdf"
    },
    {
        title: "Online Pharmaceutical Sales Regulation (FDA Administrative Order No. 2013-0027)",
        description: "Aims to improve the quality of pharmaceutical products through stricter distribution and storage standards. The order also emphasizes the importance of aligning local practices with international standards for pharmaceutical distribution and storage.",
        scenario: "Establishes the legal framework for regulating the distribution and storage of pharmaceutical products, including online sales.",
        punishment: "Administrative Order No. 2013-0027 states that violations are subject to existing administrative and legal sanctions. These sanctions are typically defined in other regulations, such as RA 9711 and its implementing rules, and can include fines, suspension of licenses, or other penalties.",
        image: "https://images.app.goo.gl/9jZGSGUy5a1SYH118",
        pdf: "https://www.fda.gov.ph/wp-content/uploads/2021/04/Administrative-Order-No.-2013-0027.pdf"
    },
    {
        title: "E-Commerce Protection Guidelines (DTI Administrative Order No. 22-01)",
        description: "Aims to increase consumer confidence in e-commerce by ensuring online businesses understand their responsibilities and adhere to fair practices.",
        scenario: "A consumer buys a product online claiming to be a specific brand. However, the received product is a counterfeit, and the seller doesn't offer a refund or exchange despite the product not being of the advertised quality.",
        punishment: "The Joint Administrative Order (JAO) includes penalties for violating regulations, reinforcing the importance of adhering to the rules.",
        image: "https://images.app.goo.gl/FPThS1qkqmuRPyDv5",
        pdf: "https://www.aseanconsumer.org/file/post_image/JAO%20NO.%2022-01.Guidelines%20on%20Online%20Businesses.pdf"
    },
    {
        title: "Guidelines on Cybercrime Prosecution (DOJ Circular No. 027, 2018)",
        description: "The circular focuses on prosecuting crimes that violate the confidentiality, integrity, and availability of computer data and systems. It also addresses offenses like illegal access, interception of data, and data interference.",
        scenario: "An individual is charged with violating Section 5 of RA 9165 (illegal sale of dangerous drugs), with a quantity of drugs within the range where a plea of guilty to a lesser offense under Section 12 (illegal possession of drug paraphernalia) might be considered. Under DOJ Circular No. 027, the prosecution would not be required to accept such a plea bargaining proposal. The prosecution would be obligated to proceed with the original charge for the illegal sale of drugs, unless there are other compelling reasons for accepting the plea.",
        punishment: "Imprisonment ranging from prision correccional (6 months and 1 day to 6 years) to prision mayor (6 years and 1 day to 12 years), depending on the severity and impact of the act.",
        image: "https://images.app.goo.gl/2Quowehw8U4pqCPH8",
        pdf: "https://www.doj.gov.ph/files/2018/DC/DC027-2018JUN%20Amended%20Guidelines%20for%20Plea%20Bargaining%20dtd%2026%20Jun%202018(1).pdf?__cf_chl_tk=WesqdnLjw1kmQGO4cTqus5pZQob.kyjwg4j4cSIvtTs-1745159710-1.0.1.1-n2KPDWigQuiNVNbkZEl0E8bMXOy8SKfjl7PfkSJWBpk"
    },
    {
        title: "PNP Anti-Cybercrime Group Operational Guidelines (PNP Circular No. 2019-001)",
        description: "This circular outlines operational guidelines for the PNP Anti-Cybercrime Group (ACG), though it's difficult to definitively confirm without access to the specific document.",
        scenario: "A social media page is used to spread false information about a recent incident, leading to panic and unrest.",
        punishment: "Cybercrime offenses, as defined by law, can carry penalties such as imprisonment (prision mayor) and/or fines.",
        image: "https://images.app.goo.gl/Nt5MrE1TZcHvjAi79",
        pdf: "https://napolcom.gov.ph/pdf/MC2019-001.pdf?__cf_chl_tk=quHo44KOQomtEkrLILHjfyPHTz1BXnpQnxT8zoELEXI-1745160065-1.0.1.1-tddcEgLIGP2bavUXSf7zbBX.CbHS8Qz8YtB7OdtLEHE"
    },
    {
        title: "Rules on Cybercrime Warrants (Supreme Court A.M. No. 17-11-03-SC)",
        description: "This outlines procedures for obtaining and executing various types of warrants related to cybercrimes. These include warrants to search, seize, and examine computer data, warrants to examine computer data, and warrants to disclose or intercept computer data. The rule also covers the effective period of warrants, the process for returning seized items, and the potential for contempt or criminal charges for non-compliance.",
        scenario: "In a case of online fraud, law enforcement can use a Warrant to Disclose Computer Data (WDCD) to obtain a suspect's online activity data, including traffic data and subscriber information, from their internet service provider to build a case against them.",
        punishment: "Failing to comply with a cybercrime warrant or obstructing justice in a cybercrime case is handled under the Cybercrime Prevention Act.",
        image: "https://elegal.ph/site/wp-content/uploads/2018/07/security.jpg",
        pdf: "https://wipolex-resources-eu-central-1-358922420655.s3.amazonaws.com/edocs/lexdocs/laws/en/ph/ph208en_1.pdf"
    },
    {
        title: "Rules on Electronic Evidence (Supreme Court A.M. No. 01-7-01-SC)",
        description: "This establishes the admissibility of electronic signatures and documents in legal proceedings. It recognizes electronic documents as functional equivalents of written documents, meaning they are admissible as evidence if properly authenticated. The rules also outline how to authenticate electronic signatures and establish the integrity and reliability of electronic data messages.",
        scenario: "An email with an electronically signed contract, authenticated through a secure platform demonstrating the signer's control and integrity of the signature, would be considered admissible electronic evidence, equivalent to a handwritten, signed paper contract, according to the Rules on Electronic Evidence.",
        punishment: "Exclusion of Evidence: An electronic document that isn't properly authenticated or doesn't meet the requirements for admissibility may be excluded from evidence. Sanctions for False or Misleading Information: Presenting false or misleading information in electronic documents could result in legal consequences, such as perjury or other fraud charges.",
        image: "https://s3.ap-south-1.amazonaws.com/novojuris/image/1603091279991_it__1_.jpg",
        pdf: "https://www.doj.gov.ph/files/rules%20on%20electronic%20evidence.pdf"
    },
    {
        title: "Revised Rules of Civil Procedure (Supreme Court A.M. No. 19-08-06-SC)",
        description: "This outlines the procedures for administrative searches and inspections conducted by the Philippine Competition Commission (PCC). This rule, effective November 16, 2019, allows the PCC to apply for Inspection Orders from Special Commercial Courts to investigate potential violations of the Philippine Competition Act.",
        scenario: "Involve a dispute over property or a debt where the amount claimed is within the jurisdiction of the first-level court.",
        punishment: "Order to take specific actions: This could include ordering a party to comply with a court order or correct a procedural error. Order to pay a fine: The court can impose a fine as a penalty for violating the rules. Order to pay attorney's fees and other expenses: If the court finds that the violation resulted in attorney's fees and other expenses, it may order the offending party to pay those costs to the other party.",
        image: "https://cdn.sanity.io/images/anl9abaw/production/cca237f4771a8e6802e1f4bf490ca2b827268c84-768x512.png?w=3840&q=75&fit=clip&auto=format",
        pdf: "https://lpr.adb.org/sites/default/files/2024-07/philippines-supreme-court-19-08-06.pdf"
    }
];

        auth.onAuthStateChanged((user) => {
            if (user) {
                const currentUser = {
                    username: user.displayName || 'User',
                    email: user.email,
                    createdAt: user.metadata.creationTime
                };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));

                usernameDisplay.textContent = `${currentUser.username}`;
                emailDisplay.textContent = `${currentUser.email}`;
                createdAtDisplay.textContent = `${new Date(currentUser.createdAt).toLocaleString()}`;

                const sanitizedEmail = currentUser.email.replace(/\./g, ',');

                const userRef = database.ref(`users/${sanitizedEmail}`);
                userRef.once('value', (snapshot) => {
                    const userData = snapshot.val();
                    if (userData) {
                        if (userData.avatarUrl) {
                            profilePic.src = userData.avatarUrl;
                        } else {
                            profilePic.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/4L1mGQAAAAASUVORK5CYII=';
                        }
                        if (userData.avatarBgColor) {
                            profilePic.style.backgroundColor = userData.avatarBgColor;
                            avatarBgColorPicker.value = userData.avatarBgColor;
                        }
                        if (userData.borderColor) {
                            profilePic.style.borderColor = userData.borderColor;
                            borderColorPicker.value = userData.borderColor;
                        }
                        if (userData.borderType) {
                            profilePic.style.borderStyle = userData.borderType;
                            borderTypeSelect.value = userData.borderType;
                        }
                    }
                }, (error) => {
                    console.error('Error loading user customization:', error);
                    alert('Failed to load user customization: ' + error.message);
                });

                // Load saved laws
                const savedLawsRef = database.ref(`users/${sanitizedEmail}/savedLaws`);
                savedLawsRef.on('value', (snapshot) => {
                    savedLawsGrid.innerHTML = '';
                    const savedLaws = [];
                    snapshot.forEach((childSnapshot) => {
                        const law = childSnapshot.val();
                        law.key = childSnapshot.key;
                        savedLaws.push(law);
                    });

                    if (savedLaws.length === 0) {
                        const noLaws = document.createElement('p');
                        noLaws.className = 'no-saved-laws';
                        noLaws.textContent = 'No saved laws found.';
                        savedLawsGrid.appendChild(noLaws);
                        clearAllBtn.style.display = 'none';
                        return;
                    }

                    clearAllBtn.style.display = 'block';

                    // Sort laws by timestamp (newest first)
                    savedLaws.sort((a, b) => b.timestamp - a.timestamp);

                    savedLaws.forEach((savedLaw) => {
                        // Find the corresponding law in the laws array to get the image and pdf
                        const lawDetails = laws.find(law => law.title === savedLaw.title);
                        if (!lawDetails) return; // Skip if law not found

                        const lawElement = document.createElement('div');
                        lawElement.className = 'saved-law-item';
                        lawElement.innerHTML = `
                            <img src="${lawDetails.image}" alt="${lawDetails.title}" class="saved-law-image">
                            <div class="saved-law-content">
                                <h3 class="saved-law-title">${savedLaw.title}</h3>
                                <p class="saved-law-timestamp">${new Date(savedLaw.timestamp).toLocaleString()}</p>
                                <div class="saved-law-actions">
                                    <button class="action-btn download-btn" data-pdf="${lawDetails.pdf}" data-title="${savedLaw.title}">
                                        <i class="fas fa-download"></i>
                                    </button>
                                    <button class="action-btn delete-btn" data-key="${savedLaw.key}">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                        savedLawsGrid.appendChild(lawElement);
                    });

                    // Add event listeners to download buttons
                    document.querySelectorAll('.download-btn').forEach((button) => {
                        button.addEventListener('click', () => {
                            const pdfUrl = button.getAttribute('data-pdf');
                            const title = button.getAttribute('data-title');
                            const sanitizedTitle = title.replace(/[^a-zA-Z0-9]/g, '_').toLowerCase();

                            // Create a hidden link to trigger the download
                            const link = document.createElement('a');
                            link.href = pdfUrl;
                            link.download = `${sanitizedTitle}.pdf`;
                            link.target = '_blank'; // In case download attribute isn't supported
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                        });
                    });

                    // Add event listeners to delete buttons
                    document.querySelectorAll('.delete-btn').forEach((button) => {
                        button.addEventListener('click', () => {
                            const key = button.getAttribute('data-key');
                            database.ref(`users/${sanitizedEmail}/savedLaws/${key}`).remove()
                                .then(() => {
                                    console.log('Law deleted successfully');
                                })
                                .catch((error) => {
                                    console.error('Error deleting law:', error);
                                    alert('Failed to delete law: ' + error.message);
                                });
                        });
                    });
                }, (error) => {
                    console.error('Error loading saved laws:', error);
                    savedLawsGrid.innerHTML = '<p class="no-saved-laws">Failed to load saved laws.</p>';
                    clearAllBtn.style.display = 'none';
                });

                // Clear All button functionality
                clearAllBtn.addEventListener('click', () => {
                    if (confirm('Are you sure you want to clear all saved laws? This action cannot be undone.')) {
                        database.ref(`users/${sanitizedEmail}/savedLaws`).remove()
                            .then(() => {
                                console.log('All saved laws cleared successfully');
                                savedLawsGrid.innerHTML = '<p class="no-saved-laws">No saved laws found.</p>';
                                clearAllBtn.style.display = 'none';
                            })
                            .catch((error) => {
                                console.error('Error clearing saved laws:', error);
                                alert('Failed to clear saved laws: ' + error.message);
                            });
                    }
                });

                loaderOverlay.classList.remove('active');
            } else {
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            }
        });

        if (localStorage.getItem('darkTheme') === 'enabled') {
            body.classList.add('dark-theme');
            themeToggle.checked = true;
        }

        themeToggle.addEventListener('change', function() {
            if (this.checked) {
                body.classList.add('dark-theme');
                localStorage.setItem('darkTheme', 'enabled');
            } else {
                body.classList.remove('dark-theme');
                localStorage.setItem('darkTheme', 'disabled');
            }
        });

        mobileMenuIcon.addEventListener('click', function() {
            sidebar.classList.toggle('active');
            const icon = mobileMenuIcon.querySelector('i');
            if (sidebar.classList.contains('active')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });

        document.querySelectorAll('a[href]').forEach(link => {
            if (link.href && !link.href.startsWith('javascript:') && !link.href.startsWith('#')) {
                link.addEventListener('click', function(e) {
                    if (!this.href.includes(window.location.hostname)) return;

                    e.preventDefault();
                    loaderOverlay.classList.add('active');

                    setTimeout(() => {
                        window.location.href = this.href;
                    }, 150);
                });
            }
        });

        profilePic.addEventListener('click', () => {
            customizationMenu.classList.toggle('active');
        });

        document.addEventListener('click', (e) => {
            if (!customizationMenu.contains(e.target) && e.target !== profilePic) {
                customizationMenu.classList.remove('active');
            }
        });

        avatarInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (!file) return;

            const validTypes = ['image/jpeg', 'image/png', 'image/jpg'];
            const maxSize = 2 * 1024 * 1024;
            if (!validTypes.includes(file.type)) {
                alert('Please upload a valid image (JPG, JPEG, PNG).');
                return;
            }
            if (file.size > maxSize) {
                alert('Image size must be less than 2MB.');
                return;
            }

            const user = auth.currentUser;
            if (!user) {
                alert('You must be logged in to upload an avatar.');
                avatarLoading.classList.remove('active');
                return;
            }

            avatarLoading.classList.add('active');

            const img = new Image();
            const reader = new FileReader();
            reader.onload = (e) => {
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);

            img.onload = () => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const maxDimension = 300;
                let width = img.width;
                let height = img.height;

                if (width > height) {
                    if (width > maxDimension) {
                        height = Math.round((height * maxDimension) / width);
                        width = maxDimension;
                    }
                } else {
                    if (height > maxDimension) {
                        width = Math.round((width * maxDimension) / height);
                        height = maxDimension;
                    }
                }

                canvas.width = width;
                canvas.height = height;
                ctx.drawImage(img, 0, 0, width, height);

                canvas.toBlob((blob) => {
                    const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                    if (!currentUser || !currentUser.email) {
                        alert('User not logged in.');
                        avatarLoading.classList.remove('active');
                        return;
                    }

                    const formData = new FormData();
                    formData.append('file', blob);
                    formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
                    formData.append('folder', `avatars/${currentUser.email}`);

                    fetch(`https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`, {
                        method: 'POST',
                        body: formData
                    })
                    .then(response => {
                        if (!response.ok) {
                            return response.text().then(text => {
                                let errorMessage = `Cloudinary upload failed with status ${response.status}`;
                                try {
                                    const parsed = JSON.parse(text);
                                    errorMessage = parsed.error?.message || text;
                                } catch (e) {
                                    errorMessage = text.includes('Invalid cloud name')
                                        ? 'Invalid Cloudinary cloud name. Please check the CLOUDINARY_CLOUD_NAME.'
                                        : text.includes('Invalid upload preset')
                                        ? 'Invalid upload preset. Please check the preset name in Cloudinary.'
                                        : text.includes('Unsigned uploads are not allowed')
                                        ? 'Unsigned uploads are not allowed. Please set the upload preset to Unsigned in Cloudinary.'
                                        : text || 'Unknown error occurred';
                                }
                                throw new Error(errorMessage);
                            });
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.error) {
                            throw new Error(data.error.message || 'Failed to upload image to Cloudinary');
                        }

                        const avatarUrl = data.secure_url;
                        const sanitizedEmail = currentUser.email.replace(/\./g, ',');

                        database.ref(`users/${sanitizedEmail}`).update({
                            avatarUrl: avatarUrl,
                            updatedAt: firebase.database.ServerValue.TIMESTAMP
                        })
                        .then(() => {
                            profilePic.src = avatarUrl;
                            avatarLoading.classList.remove('active');
                        })
                        .catch(error => {
                            console.error('Error saving avatar URL to Firebase:', error);
                            alert('Failed to save avatar URL to Firebase: ' + error.message);
                            avatarLoading.classList.remove('active');
                        });
                    })
                    .catch(error => {
                        console.error('Error uploading avatar to Cloudinary:', error);
                        alert(`Failed to upload avatar to Cloudinary: ${error.message}`);
                        avatarLoading.classList.remove('active');
                    });
                }, file.type, 0.6);
            };
            img.onerror = () => {
                alert('Failed to process the image. Please try a different file.');
                avatarLoading.classList.remove('active');
            };
        });

        avatarBgColorPicker.addEventListener('change', () => {
            const color = avatarBgColorPicker.value;
            profilePic.style.backgroundColor = color;

            const user = auth.currentUser;
            if (user) {
                const sanitizedEmail = user.email.replace(/\./g, ',');
                database.ref(`users/${sanitizedEmail}`).update({
                    avatarBgColor: color,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                })
                .catch(error => {
                    console.error('Error saving avatar background color:', error);
                    alert('Failed to save avatar background color: ' + error.message);
                });
            } else {
                alert('You must be logged in to change the avatar background color.');
            }
        });

        borderColorPicker.addEventListener('change', () => {
            const color = borderColorPicker.value;
            profilePic.style.borderColor = color;

            const user = auth.currentUser;
            if (user) {
                const sanitizedEmail = user.email.replace(/\./g, ',');
                database.ref(`users/${sanitizedEmail}`).update({
                    borderColor: color,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                })
                .catch(error => {
                    console.error('Error saving border color:', error);
                    alert('Failed to save border color: ' + error.message);
                });
            } else {
                alert('You must be logged in to change the border color.');
            }
        });

        borderTypeSelect.addEventListener('change', () => {
            const borderType = borderTypeSelect.value;
            profilePic.style.borderStyle = borderType;

            const user = auth.currentUser;
            if (user) {
                const sanitizedEmail = user.email.replace(/\./g, ',');
                database.ref(`users/${sanitizedEmail}`).update({
                    borderType: borderType,
                    updatedAt: firebase.database.ServerValue.TIMESTAMP
                })
                .catch(error => {
                    console.error('Error saving border type:', error);
                    alert('Failed to save border type: ' + error.message);
                });
            } else {
                alert('You must be logged in to change the border type.');
            }
        });
    </script>
</body>
</html>